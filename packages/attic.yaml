homeassistant:
  customize:
    light.0x0017880108ca5f8e_light:
      friendly_name: Attic Ceiling 1

    light.0x001788010929be34_light:
      friendly_name: Attic Ceiling 2

    light.0x0017880108c51275_light:
      friendly_name: Attic Ceiling 3

    light.0x00124b002116c339_light:
      friendly_name: Attic LED Strip

    sensor.0x00158d0004a015c5_humidity:
      friendly_name: "Attic Humidity"
  
    sensor.0x00158d0004a015c5_pressure:
      friendly_name: "Attic Pressure"
      
    sensor.0x00158d0004a015c5_temperature:
      friendly_name: "Attic Temperature"

    binary_sensor.0x842e14fffe4b54f2_occupancy:
      friendly_name: "Attic Occupancy"

    switch.0x84ba20fffe65529c:
      friendly_name: "Airco Power Plug (6)"
    sensor.0x84ba20fffe65529c_energy:
      friendly_name: "Airco Power Plug (6)"
    sensor.0x84ba20fffe65529c_power:
      friendly_name: "Airco Power Plug (6) - Power"

    switch.0x84ba20fffe6ac289:
      friendly_name: "WFH Area Plug (5)"
    sensor.0x84ba20fffe6ac289_energy:
      friendly_name: "WFH Area Plug (5)"
    sensor.0x84ba20fffe6ac289_power:
      friendly_name: "WFH Area Plug (5) - Power"

    switch.0x943469fffe7169b3:
      friendly_name: "WFH Laptop Plug (4)"
    sensor.0x943469fffe7169b3_energy:
      friendly_name: "WFH Laptop Plug (4)"
    sensor.0x943469fffe7169b3_power:
      friendly_name: "WFH Laptop Plug (4) - Power"
      

    switch.0x84ba20fffe6ac1ff:
      friendly_name: "Washing Machine Plug (7)" 
    sensor.0x84ba20fffe6ac1ff_energy:
      friendly_name: "Washing Machine Plug (7)"
    sensor.0x84ba20fffe6ac1ff_power:
      friendly_name: "Washing Machine Plug (7) - Power"

    binary_sensor.desktop_ag23eag_webcamactive:
      friendly_name: "Webcam Laptop Active"

light:
  - platform: group
    name: Attic Ceiling & LED Strip
    entities:
      - light.0x0017880108ca5f8e_light
      - light.0x001788010929be34_light
      - light.0x0017880108c51275_light
      - light.0x00124b002116c339_light

automation:
  - alias: Motion Detection - Attic Light off
    trigger:
      platform: state
      entity_id: binary_sensor.0x842e14fffe4b54f2_occupancy
      to: "off"
      for: "00:30:00"
    action:
      - service: light.turn_off
        entity_id: light.attic_ceiling_led_strip
      - service: light.turn_off
        entity_id: light.elgato_key_light_air
      - service: media_player.media_stop 
        target:
          entity_id: media_player.sonos_sonos_attic
      - service: climate.turn_off
        target:
          entity_id: climate.airco_zolder

  - alias: Motion Detection - Attic Light on
    trigger:
      platform: state
      entity_id: binary_sensor.0x842e14fffe4b54f2_occupancy
      to: "on"
    action:
      - service: light.turn_on
        entity_id: light.attic_ceiling_led_strip

  - alias: "Turn on attic lights via switch"
    trigger:
      - platform: state
        entity_id: binary_sensor.attic_switch
    action:
      - service: light.toggle
        entity_id: light.attic_ceiling_led_strip

  - alias: "Turn off the lights after working hours"
    trigger:
      platform: time
      at: "18:00:00"
    action:
      - service: light.turn_off
        entity_id: light.attic_ceiling_led_strip

  - alias: "Ask to turn off power"
    trigger:
      platform: time
      at: "18:00:00"
    condition:
      - condition: state
        entity_id: switch.0x943469fffe7169b3
        state: "on"
    action:
      - service: notify.mobile_app_iphone_kees
        data:
          message: "Turn of power at WFH plug?"
          data:
            actions:
              - action: "TURN_OFF_WFH_POWER"
                title: "Turn off"
                icon: "sfsymbols:person.crop.circle.badge.exclam"

  - alias: "Turn off WFH plug notification"
    trigger:
      - platform: event
        event_type: mobile_app_notification_action
        event_data:
          action: "TURN_OFF_WFH_POWER"
    action:
      - service: homeassistant.turn_off
        entity_id: switch.0x943469fffe7169b3

 
  - alias: Start Call on Laptop
    condition: 
      - condition: template
        value_template: "{{ states('device_tracker.iphone_kees') == 'home' }}"
    trigger:
      platform: state
      entity_id: binary_sensor.desktop_ag23eag_webcamactive
      to: "on"
    action:
      - service: scene.turn_on
        target:
          entity_id: scene.colorfull_attic 
      - service: light.turn_on
        entity_id: light.elgato_key_light_air
      - service: media_player.volume_mute
        data:
          is_volume_muted: true
        target:
          entity_id: media_player.sonos_sonos_attic

  - alias: End Call on Laptop
    trigger:
      platform: state
      entity_id: binary_sensor.desktop_ag23eag_webcamactive
      to: "off"
    action: 
      - service: light.turn_off
        entity_id: light.elgato_key_light_air
      - service: media_player.volume_mute
        data:
          is_volume_muted: false
        target:
          entity_id: media_player.sonos_sonos_attic

scene:
  - name: Colorfull Attic
    entities:
      light.0x0017880108ca5f8e_light:
        state: "on"
        xy_color: [0.14, 0.0]
        brightness: 255
      light.0x001788010929be34_light:
        state: "on"
        xy_color: [0.7, 0.3]
        brightness: 255
      light.0x0017880108c51275_light:
        state: "on"
        xy_color: [0.3, 0.3]
        brightness: 255
      light.0x00124b002116c339_light:
        state: "on"
        xy_color: [0.7, 0.3]
        brightness: 255

  - name: White Attic
    entities:
      light.0x0017880108ca5f8e_light:
        state: "on"
        xy_color: [0.3, 0.3]
        brightness: 255
      light.0x001788010929be34_light:
        state: "on"
        xy_color: [0.3, 0.3]
        brightness: 255
      light.0x0017880108c51275_light:
        state: "on"
        xy_color: [0.3, 0.3]
        brightness: 255
      light.0x00124b002116c339_light:
        state: "on"
        xy_color: [0.3, 0.3]
        brightness: 255 
  - name: PowerSavingOn
    entities:  
      switch.0x943469fffe716cf4:
        state: "off"
      switch.0x943469fffe7169b3:
        state: "off"
